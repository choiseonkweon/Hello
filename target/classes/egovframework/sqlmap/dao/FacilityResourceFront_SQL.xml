<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="jcep.front.dao.FacilityResourceFrontMapper">

<!-- 시설 및 자원 관리 > 시설 정보 -->
	<select id="selectFacilityUseList" parameterType="jcep.front.model.FacilityResourceFrontVO" resultType="jcep.front.model.FacilityResourceFrontVO">
			/* selectFacilityUseList */
			SELECT
				resour_faci_id AS facilityId,
				facility_nm AS facilityNm,
				facility_loc AS facilityLoc,
				facility_scale AS facilityScale,
				facility_cost AS facilityCost,
				facility_equip AS facilityEquip,
				facility_img AS facilityImg,
				facility_st_cd AS facilityStCd
			FROM tb_facility
			WHERE 1=1
			<if test="searchText != null and searchText != ''">
		        AND	facility_nm LIKE CONCAT('%',#{searchText},'%') OR facility_loc LIKE CONCAT('%',#{searchText},'%') OR facility_scale LIKE CONCAT('%',#{searchText},'%') OR facility_equip LIKE CONCAT('%',#{searchText},'%')
			</if> 
			ORDER BY reg_dt DESC
	</select>
	
	<select id="selectFacilityUseListTotCnt" parameterType="jcep.front.model.FacilityResourceFrontVO" resultType="int">
			/* selectFacilityUseListTotCnt */
			SELECT COUNT(*) totcnt
			FROM tb_facility
			WHERE 1=1
			<if test="searchText != null and searchText != ''">
		        AND	facility_nm LIKE CONCAT('%',#{searchText},'%') OR facility_loc LIKE CONCAT('%',#{searchText},'%') OR facility_scale LIKE CONCAT('%',#{searchText},'%') OR facility_equip LIKE CONCAT('%',#{searchText},'%')
			</if>  
	</select>
	
<!-- 시설 및 자원 관리 > 자원 등록 관리 -->
	<select id="selectResourceUseList" parameterType="jcep.front.model.FacilityResourceFrontVO" resultType="jcep.front.model.FacilityResourceFrontVO">
			/* selectResourceUseList */
			SELECT
				resour_faci_id AS resourFaciId,
				resource_nm AS resourceNm,
				resource_img AS resourceImg,
				(
					CASE resource_st_cd 
						WHEN 'Y' THEN '대여가능'
						WHEN 'N' THEN '대여불가능'
					END
                ) AS resourceStCd,
				date_format(reg_dt, '%Y.%m.%d') AS regDt
			FROM tb_resource
			WHERE 1=1
			<if test="searchText != null and searchText != ''">
		        <choose>
		        	<when test='searchType eq ""'>
						AND	resource_nm LIKE CONCAT('%',#{searchText},'%') 
					</when>
		            <when test='searchType eq 1'>
						AND	resource_nm LIKE CONCAT('%',#{searchText},'%')
					</when>
				</choose>
			</if> 
			ORDER BY reg_dt DESC
	</select>
	
	<select id="selectResourceUseListTotCnt" parameterType="jcep.front.model.FacilityResourceFrontVO" resultType="int">
			SELECT COUNT(*) totcnt
			FROM tb_resource
			WHERE 1=1
			<if test="searchText != null and searchText != ''">
		        <choose>
		        	<when test='searchType eq ""'>
						AND	resource_nm LIKE CONCAT('%',#{searchText},'%') 
					</when>
		            <when test='searchType eq 1'>
						AND	resource_nm LIKE CONCAT('%',#{searchText},'%')
					</when>
				</choose>
			</if>  
	</select>
	
	
	
	
	<insert id="onlineInsert" parameterType="jcep.admin.model.MemberVO">
		/* onlineInsert */
		INSERT INTO tb_onestop_support
		(
			onestop_support_no,
			member_id,
			comp_appl_nm,
			comp_posit,
			comp_tel_no,
			comp_fax_no,
			comp_hp_no,
			comp_mail,
			advice_hope_dt,
			advice_place_cd,
			advice_area_cd,
			advice_applic_cont,
			org_file_nm,
			file_course,
			reg_dt
		)
		VALUES
		(
			(select concat('S',IFNULL(LPAD(MAX(SUBSTRING(onestop_support_no,2,LENGTH(onestop_support_no))) + 1,4,'0'),'0000')) from tb_onestop_support a),
			#{memberId},
			#{compApplNm},
			#{compPosit},
			#{compTelNo},
			#{compFaxNo},
			#{compHpNo},
			#{compMail},
			#{adviceHopeDt},
			#{advicePlaceCd},
			#{adviceAreaCd},
			#{adviceApplicCont},
			#{orgFileNm},
			#{fileCourse},
			#{regDt}
		)
	</insert>
	



</mapper>














